globalThis.monorepoPackagePath = "apps/www";import process from 'node:process';import { Buffer } from 'node:buffer';import { createRequire as topLevelCreateRequire } from 'module';const require = topLevelCreateRequire(import.meta.url);import bannerUrl from 'url';const __dirname = bannerUrl.fileURLToPath(new URL('.', import.meta.url));globalThis.openNextDebug = false;globalThis.openNextVersion = "3.4.1";
var Cr=Object.defineProperty;var L=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var C=(e,r)=>()=>(e&&(r=e(e=0)),r);var z=(e,r)=>{for(var t in r)Cr(e,t,{get:r[t],enumerable:!0})};function re(e){try{return"__openNextInternal"in e}catch{return!1}}var me,I,oe=C(()=>{me=class extends Error{__openNextInternal=!0;canIgnore=!0;logLevel=0;constructor(r){super(r),this.name="IgnorableError"}},I=class extends Error{__openNextInternal=!0;canIgnore=!0;logLevel=1;constructor(r){super(r),this.name="RecoverableError"}}});function x(...e){globalThis.openNextDebug&&console.log(...e)}function Me(...e){console.warn(...e)}function S(...e){if(e.some(r=>Sr(r)))return x(...e);if(e.some(r=>re(r))){let r=e.find(t=>re(t));return r.logLevel<Tr()?void 0:r.logLevel===0?console.log(...e.map(t=>re(t)?`${t.name}: ${t.message}`:t)):r.logLevel===1?Me(...e.map(t=>re(t)?`${t.name}: ${t.message}`:t)):console.error(...e)}console.error(...e)}function Tr(){switch((process.env.OPEN_NEXT_ERROR_LOG_LEVEL??"1").toLowerCase()){case"debug":case"0":return 0;case"error":case"2":return 2;default:return 1}}var Ar,Sr,T=C(()=>{oe();Ar=[{clientName:"S3Client",commandName:"GetObjectCommand",errorName:"NoSuchKey"}],Sr=e=>Ar.some(r=>r.clientName===e?.clientName&&r.commandName===e?.commandName&&(r.errorName===e?.error?.name||r.errorName===e?.error?.Code))});import k from"node:fs";import B from"node:path";function tt(e){let r=B.join(e,"required-server-files.json"),t=k.readFileSync(r,"utf-8"),{config:o}=JSON.parse(t);return o}function rt(e){let r=B.join(e,"BUILD_ID");return k.readFileSync(r,"utf-8").trim()}function ot(e){let r=B.join(e,"server","pages-manifest.json"),t=k.readFileSync(r,"utf-8");return Object.entries(JSON.parse(t)).filter(([o,s])=>s.endsWith(".html")).map(([o])=>o)}function st(e){let r=B.join(e,"routes-manifest.json"),t=k.readFileSync(r,"utf-8"),o=JSON.parse(t),s=o.dataRoutes??[],a={static:s.filter(n=>n.routeKeys===void 0),dynamic:s.filter(n=>n.routeKeys!==void 0)};return{basePath:o.basePath,rewrites:Array.isArray(o.rewrites)?{beforeFiles:[],afterFiles:o.rewrites,fallback:[]}:{beforeFiles:o.rewrites.beforeFiles??[],afterFiles:o.rewrites.afterFiles??[],fallback:o.rewrites.fallback??[]},redirects:o.redirects??[],routes:{static:o.staticRoutes??[],dynamic:o.dynamicRoutes??[],data:a},locales:o.i18n?.locales??[]}}function at(e){let r=B.join(e,"routes-manifest.json"),t=k.readFileSync(r,"utf-8");return JSON.parse(t).headers}function nt(e){let r=B.join(e,"prerender-manifest.json"),t=k.readFileSync(r,"utf-8");return JSON.parse(t)}function it(e){let r=B.join(e,"app-path-routes-manifest.json");return k.existsSync(r)?JSON.parse(k.readFileSync(r,"utf-8")):{}}function ct(e){let r=B.join(e,"server","middleware-manifest.json"),t=k.readFileSync(r,"utf-8");return JSON.parse(t)}var dt=C(()=>{});import lt from"node:path";var F,Nr,R,J,ut,M,pt,X,ft,ht,j=C(()=>{T();dt();F=lt.join(__dirname,".next"),Nr=lt.join(__dirname,".open-next");x({NEXT_DIR:F,OPEN_NEXT_DIR:Nr});R=tt(F),J=rt(F),ut=ot(F),M=st(F),pt=at(F),X=nt(F),ft=ct(F),ht=it(F)});function mt(){let e=process.env;e.NODE_ENV=process.env.NODE_ENV??"production"}function gt(){return Math.random().toString(36).slice(2,8)}function je(e,r){return e.reduce((o,s,a)=>{let n=Math.floor(a/r);return o[n]=[...o[n]??[],s],o},new Array)}function ge(e){if(typeof e!="string")return e;let r=Number.parseInt(e);return Number.isNaN(r)?void 0:r}var se=C(()=>{});function ye(e){return e?typeof e=="string"?e.split(/(?<!Expires=\w+),/i).map(r=>r.trim()):e:[]}var xe,Pr,we=C(()=>{xe=e=>{let r={};if(!e)return r;for(let[t,o]of Object.entries(e))o!==void 0&&(r[t.toLowerCase()]=Pr(o));return r},Pr=e=>typeof e=="string"?e:Array.isArray(e)?e.join(","):String(e)});import{Transform as Hr}from"node:stream";var K,G,Ee,De=C(()=>{T();we();K="set-cookie",G="This cannot be used in OpenNext",Ee=class extends Hr{fixHeaders;onEnd;streamCreator;initialHeaders;statusCode;statusMessage="";headers={};_cookies=[];responseStream;headersSent=!1;_chunks=[];strictContentLength=!1;assignSocket(r){throw new Error(G)}detachSocket(r){throw new Error(G)}writeContinue(r){throw new Error(G)}writeEarlyHints(r,t){throw new Error(G)}writeProcessing(){throw new Error(G)}req;chunkedEncoding=!1;shouldKeepAlive=!0;useChunkedEncodingByDefault=!0;sendDate=!1;connection=null;socket=null;setTimeout(r,t){throw new Error(G)}addTrailers(r){throw new Error(G)}constructor(r,t,o,s){super(),this.fixHeaders=r,this.onEnd=t,this.streamCreator=o,this.initialHeaders=s}get originalResponse(){return this}get finished(){return this.responseStream?this.responseStream?.writableFinished:this.writableFinished}setHeader(r,t){let o=r.toLowerCase();return o===K&&(Array.isArray(t)?this._cookies=t:this._cookies=[t]),this.headers[o]=t,this}removeHeader(r){let t=r.toLowerCase();return t===K?this._cookies=[]:delete this.headers[t],this}hasHeader(r){let t=r.toLowerCase();return t===K?this._cookies.length>0:this.headers[t]!==void 0}getHeaders(){return this.headers}getHeader(r){return this.headers[r.toLowerCase()]}getHeaderNames(){return Object.keys(this.headers)}flushHeaders(){this.headersSent=!0;let r=globalThis.__openNextAls?.getStore()?.mergeHeadersPriority??"middleware";if(this.initialHeaders){this.headers=r==="middleware"?{...this.headers,...this.initialHeaders}:{...this.initialHeaders,...this.headers};let o=ye(this.initialHeaders[K]?.toString());this._cookies=r==="middleware"?[...this._cookies,...o]:[...o,...this._cookies]}this.fixHeaders(this.headers),this.fixHeadersForError(),this.headers[K]=this._cookies;let t=xe(this.headers);delete t[K],this.streamCreator&&(this.responseStream=this.streamCreator?.writeHeaders({statusCode:this.statusCode??200,cookies:this._cookies,headers:t}),this.pipe(this.responseStream))}appendHeader(r,t){let o=r.toLowerCase();if(!this.hasHeader(o))return this.setHeader(o,t);let s=this.getHeader(o),a=Array.isArray(t)?t:[t],n=Array.isArray(s)?[...s,...a]:[s,...a];return this.setHeader(o,n)}writeHead(r,t,o){let s=o,a;typeof t=="string"?a=t:s=t;let n=this.headers;if(s)if(Array.isArray(s))for(let i=0;i<s.length;i+=2)n[s[i]]=s[i+1];else for(let i of Object.keys(s))n[i]=s[i];return this.statusCode=r,o&&(this.headers=n),this.flushHeaders(),this}getFixedHeaders(){return this.fixHeaders(this.headers),this.fixHeadersForError(),this.headers[K]=this._cookies,this.headers}getBody(){return Buffer.concat(this._chunks)}_internalWrite(r,t){this._chunks.push(Buffer.from(r,t)),this.push(r,t),this.streamCreator?.onWrite?.()}_transform(r,t,o){this.headersSent||this.flushHeaders(),this._internalWrite(r,t),o()}_flush(r){this.headersSent||this.flushHeaders(),globalThis.__openNextAls?.getStore()?.pendingPromiseRunner.add(this.onEnd(this.headers));let t=this.getBody().length;this.streamCreator?.onFinish?.(t),t===0&&process.env.OPEN_NEXT_FORCE_NON_EMPTY_RESPONSE==="true"&&(x('Force writing "SOMETHING" to the response body'),this.push("SOMETHING")),r()}setHeaders(r){return r.forEach((t,o)=>{this.setHeader(o,Array.isArray(t)?t:t.toString())}),this}get sent(){return this.finished||this.headersSent}getHeaderValues(r){let t=this.getHeader(r);if(t!==void 0)return(Array.isArray(t)?t:[t]).map(o=>o.toString())}send(){let r=this.getBody();this.end(r)}body(r){return this.write(r),this}onClose(r){this.on("close",r)}redirect(r,t){return this.setHeader("Location",r),this.statusCode=t,t===308&&this.setHeader("Refresh",`0;url=${r}`),this}fixHeadersForError(){process.env.OPEN_NEXT_DANGEROUSLY_SET_ERROR_HEADERS!=="true"&&(this.statusCode===404||this.statusCode===500)&&(this.headers["cache-control"]="private, no-cache, no-store, max-age=0, must-revalidate")}}});function _e(e){if(!e)return!1;let r=e?.split(";")[0]??"";return Dr.has(r)}var Dr,ke=C(()=>{Dr=new Set(["application/octet-stream","application/epub+zip","application/msword","application/pdf","application/rtf","application/vnd.amazon.ebook","application/vnd.ms-excel","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","font/otf","font/woff","font/woff2","image/bmp","image/gif","image/jpeg","image/png","image/tiff","image/vnd.microsoft.icon","image/webp","audio/3gpp","audio/aac","audio/basic","audio/flac","audio/mpeg","audio/ogg","audio/wavaudio/webm","audio/x-aiff","audio/x-midi","audio/x-wav","video/3gpp","video/mp2t","video/mpeg","video/ogg","video/quicktime","video/webm","video/x-msvideo","application/java-archive","application/vnd.apple.installer+xml","application/x-7z-compressed","application/x-apple-diskimage","application/x-bzip","application/x-bzip2","application/x-gzip","application/x-java-archive","application/x-rar-compressed","application/x-tar","application/x-zip","application/zip","application/x-protobuf"])});function Lr(e,r,t){let o=new Map,s=e.replace(/[ \t]/g,"");if(r){let d=0;for(let c of r){let p=c.toLowerCase();if(o.set(p,{orig:c,pos:d++}),t.prefixMatch){let h=p.split("-");for(;h.pop(),h.length>0;){let m=h.join("-");o.has(m)||o.set(m,{orig:c,pos:d++})}}}}let a=s.split(","),n=[],i=new Set;for(let d=0;d<a.length;++d){let c=a[d];if(!c)continue;let p=c.split(";");if(p.length>2)throw new Error(`Invalid ${t.type} header`);let h=p[0].toLowerCase();if(!h)throw new Error(`Invalid ${t.type} header`);let m={token:h,pos:d,q:1};if(r&&o.has(h)&&(m.pref=o.get(h).pos),i.add(m.token),p.length===2){let _=p[1],[w,E]=_.split("=");if(!E||w!=="q"&&w!=="Q")throw new Error(`Invalid ${t.type} header`);let g=Number.parseFloat(E);if(g===0)continue;Number.isFinite(g)&&g<=1&&g>=.001&&(m.q=g)}n.push(m)}n.sort((d,c)=>c.q!==d.q?c.q-d.q:c.pref!==d.pref?d.pref===void 0?1:c.pref===void 0?-1:d.pref-c.pref:d.pos-c.pos);let l=n.map(d=>d.token);if(!r||!r.length)return l;let u=[];for(let d of l)if(d==="*")for(let[c,p]of o)i.has(c)||u.push(p.orig);else{let c=d.toLowerCase();o.has(c)&&u.push(o.get(c).orig)}return u}function wt(e="",r){return Lr(e,r,{type:"accept-language",prefixMatch:!0})[0]||void 0}var Et=C(()=>{});function kr(e){return R.i18n?.locales.includes(e.split("/")[1].toLowerCase())??!1}function Fr(e){let r=R.i18n,t=e.NEXT_LOCALE?.toLowerCase();return t?r?.locales.find(o=>t===o.toLowerCase()):void 0}function qr(e,r){if(r.localeDetection===!1)return r.defaultLocale;let t=Fr(e.cookies),o=wt(e.headers["accept-language"],r?.locales);return x({cookiesLocale:t,preferredLocale:o,defaultLocale:r.defaultLocale}),t??o??r.defaultLocale}function q(e){let r=R.i18n;return!r||kr(e.rawPath)?e.rawPath:`/${qr(e,r)}${e.rawPath}`}var ne=C(()=>{j();T();Et()});import Br from"node:crypto";import{Readable as vt}from"node:stream";function Re(e,r){if(!e)return!1;let t=/^https?:\/\//;return r?t.test(e)&&!e.includes(r):t.test(e)}function bt(e){return e===""?{}:e.split("&").reduce((t,o)=>{let[s,a]=o.split("=");return t[s]=a,t},{})}function _t(e,r){if(!r){let s=/\/([^?]*)\??(.*)/,a=e.match(s);return{hostname:"",pathname:a?.[1]?`/${a[1]}`:e,protocol:"",queryString:a?.[2]??""}}let t=/^(https?:)\/\/?([^\/\s]+)(\/[^?]*)?(\?.*)?/,o=e.match(t);if(!o)throw new Error(`Invalid external URL: ${e}`);return{protocol:o[1]??"https:",hostname:o[2],pathname:o[3]??"",queryString:o[4]?.slice(1)??""}}function Rt(e){let r=e.statusCode||200,t=xe(e.getFixedHeaders()),o=_e(t["content-type"])||!!t["content-encoding"],s=vt.toWeb(vt.from(e.getBody()));return{type:"core",statusCode:r,headers:t,body:s,isBase64Encoded:o}}function ie(e){let r=new URLSearchParams;Object.entries(e).forEach(([o,s])=>{Array.isArray(s)?s.forEach(a=>r.append(o,decodeURIComponent(a))):r.append(o,decodeURIComponent(s))});let t=r.toString();return t?`?${t}`:""}function Ct(e){let r=new URLSearchParams(e),t={};for(let o of r.keys()){let s=r.getAll(o);t[o]=s.length>1?s:s[0]}return t}function At(e){let r=e.middleware["/"];return r?.matchers?r.matchers.map(({regexp:t})=>new RegExp(t)):[]}function ce(e){return e.replaceAll("(.)","_\xB51_").replaceAll("(..)","_\xB52_").replaceAll("(...)","_\xB53_")}function Ce(e){return e.replaceAll("_\xB51_","(.)").replaceAll("_\xB52_","(..)").replaceAll("_\xB53_","(...)")}function St(e,r){return e==="GET"||e==="HEAD"||!r?void 0:new ReadableStream({start(o){o.enqueue(r),o.close()}})}function $r(e,r){if(e.rawPath==="/404"||e.rawPath==="/500"){if(process.env.OPEN_NEXT_DANGEROUSLY_SET_ERROR_HEADERS==="true")return;r[H.CACHE_CONTROL]="private, no-cache, no-store, max-age=0, must-revalidate";return}let t=q(e);ut.includes(t)&&(r[H.CACHE_CONTROL]="public, max-age=0, s-maxage=31536000, must-revalidate")}function Ur(e){let r=e[H.CACHE_CONTROL];r&&(Array.isArray(r)&&(r=r.join(",")),typeof r=="string"&&(e[H.CACHE_CONTROL]=r.replace(/\bstale-while-revalidate(?!=)/,"stale-while-revalidate=2592000")))}function Wr(e){R.poweredByHeader&&(e["X-OpenNext"]="1"),globalThis.openNextDebug&&(e["X-OpenNext-Version"]=globalThis.openNextVersion,e["X-OpenNext-RequestId"]=globalThis.__openNextAls.getStore()?.requestId)}async function zr(e,r,t,o){if(t[H.NEXT_CACHE]==="STALE"){let s=o?.[Symbol.for("NextInternalRequestMeta")],a=s?._nextDidRewrite?r.startsWith("/_next/data/")?`/_next/data/${J}${s?._nextRewroteUrl}.json`:s?._nextRewroteUrl:r;try{let n=d=>Br.createHash("md5").update(d).digest("hex"),i=globalThis.__openNextAls.getStore()?.requestId??"",l=globalThis.lastModified[i]>0?globalThis.lastModified[i]:"",u=t.etag??t.ETag??"";await globalThis.queue.send({MessageBody:{host:e,url:a},MessageDeduplicationId:n(`${r}-${l}-${u}`),MessageGroupId:Fe(r)})}catch(n){S(`Failed to revalidate stale page ${r}`,n)}}}function Fe(e){let r=Xr(e),t=r+=1831565813;t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61);let o=((t^t>>>14)>>>0)/4294967296,s=Number.parseInt(process.env.MAX_REVALIDATE_CONCURRENCY??"10");return`revalidate-${Math.floor(o*s)}`}function Xr(e){let r=1779033703,t=3144134277,o=1013904242,s=2773480762;for(let a=0,n;a<e.length;a++)n=e.charCodeAt(a),r=t^Math.imul(r^n,597399067),t=o^Math.imul(t^n,2869860233),o=s^Math.imul(o^n,951274213),s=r^Math.imul(s^n,2716044179);return r=Math.imul(o^r>>>18,597399067),t=Math.imul(s^t>>>22,2869860233),o=Math.imul(r^o>>>17,951274213),s=Math.imul(t^s>>>19,2716044179),r^=t^o^s,t^=r,o^=r,s^=r,r>>>0}function Kr(e){if(e[H.NEXT_CACHE]==="REVALIDATED"){e[H.CACHE_CONTROL]="private, no-cache, no-store, max-age=0, must-revalidate";return}let r=globalThis.__openNextAls.getStore()?.requestId??"",t=globalThis.lastModified[r]??0;if(e[H.NEXT_CACHE]==="HIT"&&t>0){let o=Math.round((Date.now()-t)/1e3),s=/s-maxage=(\d+)/,a=e[H.CACHE_CONTROL];if(x("cache-control",a,globalThis.lastModified,Date.now()),typeof a!="string")return;let n=a.match(s),i=n?Number.parseInt(n[1]):void 0;if(i&&i!==31536e3){let l=Math.max(i-o,1);e[H.CACHE_CONTROL]=`s-maxage=${l}, stale-while-revalidate=2592000`}}e[H.NEXT_CACHE]==="STALE"&&(e[H.CACHE_CONTROL]="s-maxage=2, stale-while-revalidate=2592000")}function qe(e,r,t){let o=e.internalEvent;return new Ee(s=>{$r(o,s),Ur(s),Wr(s),Kr(s)},async s=>{await zr(o.headers.host,o.rawPath,s),await Gr(e,s)},t,r)}async function Gr(e,r){let{internalEvent:t,initialPath:o,resolvedRoutes:s}=e;!(t.headers["x-isr"]==="1")&&r[H.NEXT_CACHE]==="REVALIDATED"&&await globalThis.cdnInvalidationHandler.invalidatePaths([{initialPath:o,rawPath:t.rawPath,resolvedRoutes:s}])}var H,V=C(()=>{j();De();we();T();ke();ne();(function(e){e.CACHE_CONTROL="cache-control",e.NEXT_CACHE="x-nextjs-cache"})(H||(H={}))});import{Readable as Z}from"node:stream";function Tt(e,r){let t=e.getReader(),o=[];return new Promise((s,a)=>{function n(){t.read().then(({done:i,value:l})=>{if(i){s(Buffer.concat(o).toString(r?"base64":"utf8"));return}o.push(l),n()}).catch(a)}n()})}function Ae(e,r){return Z.toWeb(Z.from(Buffer.from(e,r?"base64":"utf8")))}function Q(){return process.env.OPEN_NEXT_FORCE_NON_EMPTY_RESPONSE==="true"?Z.toWeb(Z.from([Buffer.from("SOMETHING")])):Z.toWeb(Z.from([]))}var de=C(()=>{});function Kt(e){let r={};for(let[t,o]of Object.entries(e))o!==void 0&&(r[t]=o);return r}var Gt=C(()=>{});var Qt={};z(Qt,{default:()=>Co});function vo(e){let{body:r,isBase64Encoded:t}=e;return Buffer.isBuffer(r)?r:typeof r=="string"?Buffer.from(r,t?"base64":"utf8"):typeof r=="object"?Buffer.from(JSON.stringify(r)):Buffer.from("","utf8")}function bo(e){let{headers:r,cookies:t}=e,o={};Array.isArray(t)&&(o.cookie=t.join("; "));for(let[s,a]of Object.entries(r||{}))o[s.toLowerCase()]=a;return o}async function _o(e){let{rawPath:r,rawQueryString:t,requestContext:o}=e;return{type:"core",method:o.http.method,rawPath:r,url:r+(t?`?${t}`:""),body:vo(e),headers:bo(e),remoteAddress:o.http.sourceIp,query:Kt(Ct(t)),cookies:e.cookies?.reduce((s,a)=>{let[n,i]=a.split("=");return s[n]=i,s},{})??{}}}async function Ro(e){let r={};Object.entries(e.headers).map(([s,a])=>[s.toLowerCase(),a]).filter(([s])=>!Eo.some(a=>typeof a=="string"?a===s:a.test(s))).forEach(([s,a])=>{if(a==null){r[s]="";return}r[s]=Array.isArray(a)?a.join(", "):`${a}`});let t=await Tt(e.body,e.isBase64Encoded),o={statusCode:e.statusCode,headers:r,cookies:ye(e.headers["set-cookie"]),body:t,isBase64Encoded:e.isBase64Encoded};return x(o),o}var Eo,Co,Yt=C(()=>{we();de();T();V();Gt();Eo=["connection","expect","keep-alive","proxy-authenticate","proxy-authorization","proxy-connection","trailer","upgrade","x-accel-buffering","x-accel-charset","x-accel-limit-rate","x-accel-redirect",/x-amz-cf-(.*)/,/x-amzn-(.*)/,/x-edge-(.*)/,"x-cache","x-forwarded-proto","x-real-ip","set-cookie","age","via"];Co={convertFrom:_o,convertTo:Ro,name:"aws-apigw-v2"}});var Jt={};z(Jt,{default:()=>No});import{Readable as Ao}from"node:stream";import Y from"node:zlib";function So(e){return new Promise(t=>{setTimeout(()=>{t({serverId,type:"warmer"})},e.delay)})}var To,No,Vt=C(()=>{T();To=async(e,r)=>awslambda.streamifyResponse(async(t,o,s)=>{if(s.callbackWaitsForEmptyEventLoop=!1,"type"in t){let p=await So(t);o.end(Buffer.from(JSON.stringify(p)),"utf-8");return}let a=await r.convertFrom(t),n=a.headers["Accept-Encoding"]??a.headers["accept-encoding"]??"",i,l;o.on("error",p=>{S(p),o.end()}),n.includes("br")?(i="br",l=Y.createBrotliCompress({flush:Y.constants.BROTLI_OPERATION_FLUSH,finishFlush:Y.constants.BROTLI_OPERATION_FINISH}),l.pipe(o)):n.includes("gzip")?(i="gzip",l=Y.createGzip({flush:Y.constants.Z_SYNC_FLUSH}),l.pipe(o)):n.includes("deflate")?(i="deflate",l=Y.createDeflate({flush:Y.constants.Z_SYNC_FLUSH}),l.pipe(o)):(i="identity",l=o);let u={writeHeaders:p=>{o.setContentType("application/vnd.awslambda.http-integration-response"),p.headers["content-encoding"]=i;let h=JSON.stringify(p);return o.write(h),o.write(new Uint8Array(8)),l??o}},d=await e(a,u);if(globalThis.isEdgeRuntime??!1){x("Headers has not been set, we must be in the edge runtime");let p=u.writeHeaders({statusCode:d.statusCode,headers:d.headers,cookies:[]});Ao.fromWeb(d.body).pipe(p)}}),No={wrapper:To,name:"aws-lambda-streaming",supportStreaming:!0}});async function fe(e,r){let t=await crypto.subtle.importKey("raw",typeof e=="string"?Je.encode(e):e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return crypto.subtle.sign("HMAC",t,Je.encode(r))}async function Zt(e){return crypto.subtle.digest("SHA-256",typeof e=="string"?Je.encode(e):e)}function Ye(e){let r=new Uint8Array(e),t="";for(let o=0;o<r.length;o++){let s=r[o];t+=er[s>>>4&15],t+=er[s&15]}return t}function tr(e){return e.replace(/[!'()*]/g,r=>"%"+r.charCodeAt(0).toString(16).toUpperCase())}function Oo(e,r){let{hostname:t,pathname:o}=e;if(t.endsWith(".on.aws")){let i=t.match(/^[^.]{1,63}\.lambda-url\.([^.]{1,63})\.on\.aws$/);return i!=null?["lambda",i[1]||""]:["",""]}if(t.endsWith(".r2.cloudflarestorage.com"))return["s3","auto"];if(t.endsWith(".backblazeb2.com")){let i=t.match(/^(?:[^.]{1,63}\.)?s3\.([^.]{1,63})\.backblazeb2\.com$/);return i!=null?["s3",i[1]||""]:["",""]}let s=t.replace("dualstack.","").match(/([^.]{1,63})\.(?:([^.]{0,63})\.)?amazonaws\.com(?:\.cn)?$/),a=s&&s[1]||"",n=s&&s[2];if(n==="us-gov")n="us-gov-west-1";else if(n==="s3"||n==="s3-accelerate")n="us-east-1",a="s3";else if(a==="iot")t.startsWith("iot.")?a="execute-api":t.startsWith("data.jobs.iot.")?a="iot-jobs-data":a=o==="/mqtt"?"iotdevicegateway":"iotdata";else if(a==="autoscaling"){let i=(r.get("X-Amz-Target")||"").split(".")[0];i==="AnyScaleFrontendService"?a="application-autoscaling":i==="AnyScaleScalingPlannerFrontendService"&&(a="autoscaling-plans")}else n==null&&a.startsWith("s3-")?(n=a.slice(3).replace(/^fips-|^external-1/,""),a="s3"):a.endsWith("-fips")?a=a.slice(0,-5):n&&/-\d$/.test(a)&&!/-\d$/.test(n)&&([a,n]=[n,a]);return[Po[a]||a,n||""]}var Je,Po,Ho,U,Ve,er,Te=C(()=>{Je=new TextEncoder,Po={appstream2:"appstream",cloudhsmv2:"cloudhsm",email:"ses",marketplace:"aws-marketplace",mobile:"AWSMobileHubService",pinpoint:"mobiletargeting",queue:"sqs","git-codecommit":"codecommit","mturk-requester-sandbox":"mturk-requester","personalize-runtime":"personalize"},Ho=new Set(["authorization","content-type","content-length","user-agent","presigned-expires","expect","x-amzn-trace-id","range","connection"]),U=class{constructor({accessKeyId:r,secretAccessKey:t,sessionToken:o,service:s,region:a,cache:n,retries:i,initRetryMs:l}){if(r==null)throw new TypeError("accessKeyId is a required option");if(t==null)throw new TypeError("secretAccessKey is a required option");this.accessKeyId=r,this.secretAccessKey=t,this.sessionToken=o,this.service=s,this.region=a,this.cache=n||new Map,this.retries=i??10,this.initRetryMs=l||50}async sign(r,t){if(r instanceof Request){let{method:a,url:n,headers:i,body:l}=r;t=Object.assign({method:a,url:n,headers:i},t),t.body==null&&i.has("Content-Type")&&(t.body=l!=null&&i.has("X-Amz-Content-Sha256")?l:await r.clone().arrayBuffer()),r=n}let o=new Ve(Object.assign({url:r.toString()},t,this,t&&t.aws)),s=Object.assign({},t,await o.sign());delete s.aws;try{return new Request(s.url.toString(),s)}catch(a){if(a instanceof TypeError)return new Request(s.url.toString(),Object.assign({duplex:"half"},s));throw a}}async fetch(r,t){for(let o=0;o<=this.retries;o++){let s=fetch(await this.sign(r,t));if(o===this.retries)return s;let a=await s;if(a.status<500&&a.status!==429)return a;await new Promise(n=>setTimeout(n,Math.random()*this.initRetryMs*Math.pow(2,o)))}throw new Error("An unknown error occurred, ensure retries is not negative")}},Ve=class{constructor({method:r,url:t,headers:o,body:s,accessKeyId:a,secretAccessKey:n,sessionToken:i,service:l,region:u,cache:d,datetime:c,signQuery:p,appendSessionToken:h,allHeaders:m,singleEncode:_}){if(t==null)throw new TypeError("url is a required option");if(a==null)throw new TypeError("accessKeyId is a required option");if(n==null)throw new TypeError("secretAccessKey is a required option");this.method=r||(s?"POST":"GET"),this.url=new URL(t),this.headers=new Headers(o||{}),this.body=s,this.accessKeyId=a,this.secretAccessKey=n,this.sessionToken=i;let w,E;(!l||!u)&&([w,E]=Oo(this.url,this.headers)),this.service=l||w||"",this.region=u||E||"us-east-1",this.cache=d||new Map,this.datetime=c||new Date().toISOString().replace(/[:-]|\.\d{3}/g,""),this.signQuery=p,this.appendSessionToken=h||this.service==="iotdevicegateway",this.headers.delete("Host"),this.service==="s3"&&!this.signQuery&&!this.headers.has("X-Amz-Content-Sha256")&&this.headers.set("X-Amz-Content-Sha256","UNSIGNED-PAYLOAD");let g=this.signQuery?this.url.searchParams:this.headers;if(g.set("X-Amz-Date",this.datetime),this.sessionToken&&!this.appendSessionToken&&g.set("X-Amz-Security-Token",this.sessionToken),this.signableHeaders=["host",...this.headers.keys()].filter(f=>m||!Ho.has(f)).sort(),this.signedHeaders=this.signableHeaders.join(";"),this.canonicalHeaders=this.signableHeaders.map(f=>f+":"+(f==="host"?this.url.host:(this.headers.get(f)||"").replace(/\s+/g," "))).join(`
`),this.credentialString=[this.datetime.slice(0,8),this.region,this.service,"aws4_request"].join("/"),this.signQuery&&(this.service==="s3"&&!g.has("X-Amz-Expires")&&g.set("X-Amz-Expires","86400"),g.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),g.set("X-Amz-Credential",this.accessKeyId+"/"+this.credentialString),g.set("X-Amz-SignedHeaders",this.signedHeaders)),this.service==="s3")try{this.encodedPath=decodeURIComponent(this.url.pathname.replace(/\+/g," "))}catch{this.encodedPath=this.url.pathname}else this.encodedPath=this.url.pathname.replace(/\/+/g,"/");_||(this.encodedPath=encodeURIComponent(this.encodedPath).replace(/%2F/g,"/")),this.encodedPath=tr(this.encodedPath);let y=new Set;this.encodedSearch=[...this.url.searchParams].filter(([f])=>{if(!f)return!1;if(this.service==="s3"){if(y.has(f))return!1;y.add(f)}return!0}).map(f=>f.map(v=>tr(encodeURIComponent(v)))).sort(([f,v],[b,P])=>f<b?-1:f>b?1:v<P?-1:v>P?1:0).map(f=>f.join("=")).join("&")}async sign(){return this.signQuery?(this.url.searchParams.set("X-Amz-Signature",await this.signature()),this.sessionToken&&this.appendSessionToken&&this.url.searchParams.set("X-Amz-Security-Token",this.sessionToken)):this.headers.set("Authorization",await this.authHeader()),{method:this.method,url:this.url,headers:this.headers,body:this.body}}async authHeader(){return["AWS4-HMAC-SHA256 Credential="+this.accessKeyId+"/"+this.credentialString,"SignedHeaders="+this.signedHeaders,"Signature="+await this.signature()].join(", ")}async signature(){let r=this.datetime.slice(0,8),t=[this.secretAccessKey,r,this.region,this.service].join(),o=this.cache.get(t);if(!o){let s=await fe("AWS4"+this.secretAccessKey,r),a=await fe(s,this.region),n=await fe(a,this.service);o=await fe(n,"aws4_request"),this.cache.set(t,o)}return Ye(await fe(o,await this.stringToSign()))}async stringToSign(){return["AWS4-HMAC-SHA256",this.datetime,this.credentialString,Ye(await Zt(await this.canonicalString()))].join(`
`)}async canonicalString(){return[this.method.toUpperCase(),this.encodedPath,this.encodedSearch,this.canonicalHeaders+`
`,this.signedHeaders,await this.hexBodyHash()].join(`
`)}async hexBodyHash(){let r=this.headers.get("X-Amz-Content-Sha256")||(this.service==="s3"&&this.signQuery?"UNSIGNED-PAYLOAD":null);if(r==null){if(this.body&&typeof this.body!="string"&&!("byteLength"in this.body))throw new Error("body must be a string, ArrayBuffer or ArrayBufferView, unless you include the X-Amz-Content-Sha256 header");r=Ye(await Zt(this.body||""))}return r}};er=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"]});function te(e){return async(r,t)=>{let o=await e.sign(r,t),s={};return o.headers.forEach((i,l)=>{s[l]=i}),(await globalThis.internalFetch(o.url,{method:o.method,headers:s,body:t.body})).clone()}}var Ne=C(()=>{});var rr,or=C(()=>{rr=()=>{let e=process.env.DYNAMO_BATCH_WRITE_COMMAND_CONCURRENCY,r=e?Number.parseInt(e):void 0;return r&&!Number.isNaN(r)?r:4}});var sr={};z(sr,{default:()=>ko});import Mo from"node:path";function he(e){let{NEXT_BUILD_ID:r}=process.env;return Mo.posix.join(r??"",e)}function Do(e,r,t){return{path:{S:he(e)},tag:{S:he(r)},revalidatedAt:{N:`${t??Date.now()}`}}}var Pe,jo,He,Lo,ko,ar=C(()=>{Te();oe();Ne();T();se();or();Pe=null,jo=()=>{let{CACHE_BUCKET_REGION:e}=process.env;return Pe||(Pe=new U({accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,sessionToken:process.env.AWS_SESSION_TOKEN,region:e,retries:ge(process.env.AWS_SDK_S3_MAX_ATTEMPTS)}),Pe)},He=(e,r="query")=>{let{CACHE_BUCKET_REGION:t}=process.env,o=jo();return te(o)(`https://dynamodb.${t}.amazonaws.com`,{method:"POST",headers:{"Content-Type":"application/x-amz-json-1.0","X-Amz-Target":`DynamoDB_20120810.${r==="query"?"Query":"BatchWriteItem"}`},body:e})};Lo={async getByPath(e){try{if(globalThis.openNextConfig.dangerous?.disableTagCache)return[];let{CACHE_DYNAMO_TABLE:r,NEXT_BUILD_ID:t}=process.env,o=await He(JSON.stringify({TableName:r,IndexName:"revalidate",KeyConditionExpression:"#key = :key",ExpressionAttributeNames:{"#key":"path"},ExpressionAttributeValues:{":key":{S:he(e)}}}));if(o.status!==200)throw new I(`Failed to get tags by path: ${o.status}`);let{Items:s}=await o.json(),a=s?.map(n=>n.tag.S??"")??[];return x("tags for path",e,a),a.map(n=>n.replace(`${t}/`,""))}catch(r){return S("Failed to get tags by path",r),[]}},async getByTag(e){try{if(globalThis.openNextConfig.dangerous?.disableTagCache)return[];let{CACHE_DYNAMO_TABLE:r,NEXT_BUILD_ID:t}=process.env,o=await He(JSON.stringify({TableName:r,KeyConditionExpression:"#tag = :tag",ExpressionAttributeNames:{"#tag":"tag"},ExpressionAttributeValues:{":tag":{S:he(e)}}}));if(o.status!==200)throw new I(`Failed to get by tag: ${o.status}`);let{Items:s}=await o.json();return s?.map(({path:{S:a}})=>a?.replace(`${t}/`,"")??"")??[]}catch(r){return S("Failed to get by tag",r),[]}},async getLastModified(e,r){try{if(globalThis.openNextConfig.dangerous?.disableTagCache)return r??Date.now();let{CACHE_DYNAMO_TABLE:t}=process.env,o=await He(JSON.stringify({TableName:t,IndexName:"revalidate",KeyConditionExpression:"#key = :key AND #revalidatedAt > :lastModified",ExpressionAttributeNames:{"#key":"path","#revalidatedAt":"revalidatedAt"},ExpressionAttributeValues:{":key":{S:he(e)},":lastModified":{N:String(r??0)}}}));if(o.status!==200)throw new I(`Failed to get last modified: ${o.status}`);let s=(await o.json()).Items??[];return x("revalidatedTags",s),s.length>0?-1:r??Date.now()}catch(t){return S("Failed to get revalidated tags",t),r??Date.now()}},async writeTags(e){try{let{CACHE_DYNAMO_TABLE:r}=process.env;if(globalThis.openNextConfig.dangerous?.disableTagCache)return;let t=je(e,25).map(s=>({RequestItems:{[r??""]:s.map(a=>({PutRequest:{Item:{...Do(a.path,a.tag,a.revalidatedAt)}}}))}})),o=je(t,rr());for(let s of o)await Promise.all(s.map(async a=>{let n=await He(JSON.stringify(a),"batchWrite");if(n.status!==200)throw new I(`Failed to batch write dynamo item: ${n.status}`);return n}))}catch(r){S("Failed to batch write dynamo item",r)}},name:"dynamoDb"},ko=Lo});var nr={};z(nr,{default:()=>$o});var Oe,Fo,qo,Bo,$o,ir=C(()=>{Te();oe();Ne();T();Oe=null,Fo=()=>Oe||(Oe=new U({accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,sessionToken:process.env.AWS_SESSION_TOKEN,region:process.env.REVALIDATION_QUEUE_REGION}),Oe),qo=e=>{let{REVALIDATION_QUEUE_REGION:r}=process.env,t=Fo();return te(t)(`https://sqs.${r??"us-east-1"}.amazonaws.com`,{method:"POST",headers:{"Content-Type":"application/x-amz-json-1.0","X-Amz-Target":"AmazonSQS.SendMessage"},body:e})},Bo={send:async({MessageBody:e,MessageDeduplicationId:r,MessageGroupId:t})=>{try{let{REVALIDATION_QUEUE_URL:o}=process.env,s=await qo(JSON.stringify({QueueUrl:o,MessageBody:JSON.stringify(e),MessageDeduplicationId:r,MessageGroupId:t}));if(s.status!==200)throw new I(`Failed to send message: ${s.status}`)}catch(o){S(o)}},name:"sqs"},$o=Bo});var dr={};z(dr,{default:()=>zo,getAwsClient:()=>cr});import Uo from"node:path";function et(e,r){let{CACHE_BUCKET_KEY_PREFIX:t,NEXT_BUILD_ID:o}=process.env;return Uo.posix.join(t??"",r==="fetch"?"__fetch":"",o??"",r==="fetch"?e:`${e}.${r}`)}var Ie,cr,Ze,Wo,zo,lr=C(()=>{Te();oe();Ne();se();Ie=null,cr=()=>{let{CACHE_BUCKET_REGION:e}=process.env;return Ie||(Ie=new U({accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,sessionToken:process.env.AWS_SESSION_TOKEN,region:e,retries:ge(process.env.AWS_SDK_S3_MAX_ATTEMPTS)}),Ie)},Ze=async(e,r)=>{let{CACHE_BUCKET_REGION:t,CACHE_BUCKET_NAME:o}=process.env,s=cr(),a=`https://${o}.s3.${t}.amazonaws.com/${e}`;return te(s)(a,r)};Wo={async get(e,r){let t=await Ze(et(e,r?"fetch":"cache"),{method:"GET"});if(t.status===404)throw new me("Not found");if(t.status!==200)throw new I(`Failed to get cache: ${t.status}`);return{value:await t.json(),lastModified:new Date(t.headers.get("last-modified")??"").getTime()}},async set(e,r,t){let o=await Ze(et(e,t?"fetch":"cache"),{method:"PUT",body:JSON.stringify(r)});if(o.status!==200)throw new I(`Failed to set cache: ${o.status}`)},async delete(e){let r=await Ze(et(e,"cache"),{method:"DELETE"});if(r.status!==204)throw new I(`Failed to delete cache: ${r.status}`)},name:"s3"},zo=Wo});var pr={};z(pr,{default:()=>Qo});import{request as Xo}from"node:https";import{Readable as Ko}from"node:stream";function ur(e){let r={},t=["host","connection","via","x-cache","transfer-encoding","content-encoding","content-length"];return Object.entries(e).filter(([o,s])=>{let a=o.toLowerCase();return!(t.includes(a)||a.startsWith("x-amz"))}).forEach(([o,s])=>{r[o]=s?.toString()??""}),r}var Go,Qo,fr=C(()=>{T();ke();Go={name:"node-proxy",proxy:e=>{let{url:r,headers:t,method:o,body:s}=e;return x("proxyRequest",r),new Promise((a,n)=>{let i=ur(t);x("filteredHeaders",i);let l=Xo(r,{headers:i,method:o,rejectUnauthorized:!1},u=>{let d=u.headers,c=d["content-encoding"]==="br"?u.pipe(L("node:zlib").createBrotliDecompress()):d["content-encoding"]==="gzip"?u.pipe(L("node:zlib").createGunzip()):u,p=_e(d["content-type"])||!!d["content-encoding"],h={type:"core",headers:ur(d),statusCode:u.statusCode??200,isBase64Encoded:p,body:Ko.toWeb(c)};a(h),u.on("error",m=>{S("proxyRequest error",m),n(m)})});s&&o!=="GET"&&o!=="HEAD"&&l.write(s),l.end()})}},Qo=Go});var hr={};z(hr,{default:()=>Yo});var Yo,mr=C(()=>{Yo={name:"dummy",invalidatePaths:e=>Promise.resolve()}});j();T();se();import{AsyncLocalStorage as yo}from"node:async_hooks";De();import Or from"node:http";var ae=class extends Or.IncomingMessage{constructor({method:r,url:t,headers:o,body:s,remoteAddress:a}){super({encrypted:!0,readable:!1,remoteAddress:a,address:()=>({port:443}),end:Function.prototype,destroy:Function.prototype}),s&&(o["content-length"]??=String(Buffer.byteLength(s))),Object.assign(this,{ip:a,complete:!0,httpVersion:"1.1",httpVersionMajor:"1",httpVersionMinor:"1",method:r,headers:o,body:s,url:t}),this._read=()=>{this.push(s),this.push(null)}}};T();var ve=class{resolve;reject;promise;constructor(){let r,t;this.promise=new Promise((o,s)=>{r=o,t=s}),this.resolve=r,this.reject=t}},Le=class{promises=[];withResolvers(){let r=new ve;return this.promises.push(r),r}add(r){let t=new ve;this.promises.push(t),r.then(t.resolve,t.reject)}async await(){x(`Awaiting ${this.promises.length} detached promises`),(await Promise.allSettled(this.promises.map(o=>o.promise))).filter(o=>o.status==="rejected").forEach(o=>{S(o.reason)})}};async function Ir(){let e=globalThis.__openNextAls.getStore()?.pendingPromiseRunner.await()??Promise.resolve();if(globalThis.openNextWaitUntil){globalThis.openNextWaitUntil(e);return}await e}function Mr(){let e=Symbol.for("@next/request-context"),r=Symbol.for("@vercel/request-context"),t=globalThis.__openNextAls.getStore(),o=globalThis.openNextWaitUntil??(a=>t?.pendingPromiseRunner.add(a)),s={get:()=>({waitUntil:o})};globalThis[e]=s,process.env.EMULATE_VERCEL_REQUEST_CONTEXT&&(globalThis[r]=s)}function xt({isISRRevalidation:e},r){return globalThis.__openNextAls.run({requestId:Math.random().toString(36),pendingPromiseRunner:new Le,isISRRevalidation:e},async()=>{Mr();let t=await r();return await Ir(),t})}T();var be=L("node:module"),jr=be._resolveFilename;function yt(){be._resolveFilename=((e,r,t,o,s)=>r.endsWith("static-generation-async-storage.external")||r.endsWith("static-generation-async-storage.external.js")?L.resolve("./patchedAsyncStorage.cjs"):r.endsWith("static-generation-async-storage.external.original")?e.call(be,r.replace(".original",".js"),t,o,s):e.call(be,r,t,o,s)).bind(null,jr)}V();j();T();j();de();T();ne();V();import{createHash as Qr}from"node:crypto";var le=60*60*24*365,Nt=60*60*24*30;async function Pt(e,r,t,o,s){let a=le,n=Object.entries(X.routes).find(d=>d[0]===e)?.[1];o===void 0&&n?a=n.initialRevalidateSeconds===!1?le:n.initialRevalidateSeconds:o!==void 0&&(a=o===!1?le:o);let i=Math.round((Date.now()-(s??0))/1e3),l=d=>Qr("md5").update(d).digest("hex"),u=l(r);if(o===0)return{"cache-control":"private, no-cache, no-store, max-age=0, must-revalidate","x-opennext-cache":"ERROR",etag:u};if(a!==le){let d=Math.max(a-i,1);x("sMaxAge",{finalRevalidate:a,age:i,lastModified:s,revalidate:o});let c=d===1;if(c){let p=R.trailingSlash?`${e}/`:e;R.basePath&&(p=`${R.basePath}${p}`),await globalThis.queue.send({MessageBody:{host:t,url:p},MessageDeduplicationId:l(`${e}-${s}-${u}`),MessageGroupId:Fe(e)})}return{"cache-control":`s-maxage=${d}, stale-while-revalidate=${Nt}`,"x-opennext-cache":c?"STALE":"HIT",etag:u}}return{"cache-control":`s-maxage=${le}, stale-while-revalidate=${Nt}`,"x-opennext-cache":"HIT",etag:u}}async function Yr(e,r,t,o){x("Returning result from experimental cache");let s="",a="application/octet-stream",n=!1;switch(t.type){case"app":n=!!e.headers.rsc,s=n?t.rsc:t.html,a=n?"text/x-component":"text/html; charset=utf-8";break;case"page":n=!!e.query.__nextDataReq,s=n?JSON.stringify(t.json):t.html,a=n?"application/json":"text/html; charset=utf-8";break}let i=await Pt(r,s,e.headers.host,t.revalidate,o);return{type:"core",statusCode:200,body:Ae(s,!1),isBase64Encoded:!1,headers:{...i,"content-type":a,...t.meta?.headers}}}async function Ht(e){if(e.headers["next-action"]||e.headers["x-prerender-revalidate"])return e;let r=q(e);R.basePath&&(r=r.replace(R.basePath,"")),r=r.replace(/\/$/,""),r===""&&(r="index"),x("Checking cache for",r,X);let t=Object.keys(X.routes).includes(r)||Object.values(X.dynamicRoutes).some(o=>new RegExp(o.routeRegex).test(r));if(x("isISR",t),t)try{let o=await globalThis.incrementalCache.get(r);if(x("cached data in interceptor",o),o.value?.type==="app"&&await globalThis.tagCache.getLastModified(r,o.lastModified)===-1)return e;let s=e.headers.host;switch(o.value?.type){case"app":case"page":return Yr(e,r,o.value,o.lastModified);case"redirect":{let a=await Pt(r,"",s,o.value.revalidate,o.lastModified);return{type:"core",statusCode:o.value.meta?.status??307,body:Q(),headers:{...o.value.meta?.headers??{},...a},isBase64Encoded:!1}}default:return e}}catch(o){return x("Error while fetching cache",o),e}return e}j();function Jr(e){for(var r=[],t=0;t<e.length;){var o=e[t];if(o==="*"||o==="+"||o==="?"){r.push({type:"MODIFIER",index:t,value:e[t++]});continue}if(o==="\\"){r.push({type:"ESCAPED_CHAR",index:t++,value:e[t++]});continue}if(o==="{"){r.push({type:"OPEN",index:t,value:e[t++]});continue}if(o==="}"){r.push({type:"CLOSE",index:t,value:e[t++]});continue}if(o===":"){for(var s="",a=t+1;a<e.length;){var n=e.charCodeAt(a);if(n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||n===95){s+=e[a++];continue}break}if(!s)throw new TypeError("Missing parameter name at ".concat(t));r.push({type:"NAME",index:t,value:s}),t=a;continue}if(o==="("){var i=1,l="",a=t+1;if(e[a]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(a));for(;a<e.length;){if(e[a]==="\\"){l+=e[a++]+e[a++];continue}if(e[a]===")"){if(i--,i===0){a++;break}}else if(e[a]==="("&&(i++,e[a+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(a));l+=e[a++]}if(i)throw new TypeError("Unbalanced pattern at ".concat(t));if(!l)throw new TypeError("Missing pattern at ".concat(t));r.push({type:"PATTERN",index:t,value:l}),t=a;continue}r.push({type:"CHAR",index:t,value:e[t++]})}return r.push({type:"END",index:t,value:""}),r}function Ot(e,r){r===void 0&&(r={});for(var t=Jr(e),o=r.prefixes,s=o===void 0?"./":o,a=r.delimiter,n=a===void 0?"/#?":a,i=[],l=0,u=0,d="",c=function(N){if(u<t.length&&t[u].type===N)return t[u++].value},p=function(N){var A=c(N);if(A!==void 0)return A;var O=t[u],W=O.type,Rr=O.index;throw new TypeError("Unexpected ".concat(W," at ").concat(Rr,", expected ").concat(N))},h=function(){for(var N="",A;A=c("CHAR")||c("ESCAPED_CHAR");)N+=A;return N},m=function(N){for(var A=0,O=n;A<O.length;A++){var W=O[A];if(N.indexOf(W)>-1)return!0}return!1},_=function(N){var A=i[i.length-1],O=N||(A&&typeof A=="string"?A:"");if(A&&!O)throw new TypeError('Must have text between two parameters, missing text after "'.concat(A.name,'"'));return!O||m(O)?"[^".concat($(n),"]+?"):"(?:(?!".concat($(O),")[^").concat($(n),"])+?")};u<t.length;){var w=c("CHAR"),E=c("NAME"),g=c("PATTERN");if(E||g){var y=w||"";s.indexOf(y)===-1&&(d+=y,y=""),d&&(i.push(d),d=""),i.push({name:E||l++,prefix:y,suffix:"",pattern:g||_(y),modifier:c("MODIFIER")||""});continue}var f=w||c("ESCAPED_CHAR");if(f){d+=f;continue}d&&(i.push(d),d="");var v=c("OPEN");if(v){var y=h(),b=c("NAME")||"",P=c("PATTERN")||"",D=h();p("CLOSE"),i.push({name:b||(P?l++:""),pattern:b&&!P?_(y):P,prefix:y,suffix:D,modifier:c("MODIFIER")||""});continue}p("END")}return i}function ee(e,r){return Vr(Ot(e,r),r)}function Vr(e,r){r===void 0&&(r={});var t=$e(r),o=r.encode,s=o===void 0?function(l){return l}:o,a=r.validate,n=a===void 0?!0:a,i=e.map(function(l){if(typeof l=="object")return new RegExp("^(?:".concat(l.pattern,")$"),t)});return function(l){for(var u="",d=0;d<e.length;d++){var c=e[d];if(typeof c=="string"){u+=c;continue}var p=l?l[c.name]:void 0,h=c.modifier==="?"||c.modifier==="*",m=c.modifier==="*"||c.modifier==="+";if(Array.isArray(p)){if(!m)throw new TypeError('Expected "'.concat(c.name,'" to not repeat, but got an array'));if(p.length===0){if(h)continue;throw new TypeError('Expected "'.concat(c.name,'" to not be empty'))}for(var _=0;_<p.length;_++){var w=s(p[_],c);if(n&&!i[d].test(w))throw new TypeError('Expected all "'.concat(c.name,'" to match "').concat(c.pattern,'", but got "').concat(w,'"'));u+=c.prefix+w+c.suffix}continue}if(typeof p=="string"||typeof p=="number"){var w=s(String(p),c);if(n&&!i[d].test(w))throw new TypeError('Expected "'.concat(c.name,'" to match "').concat(c.pattern,'", but got "').concat(w,'"'));u+=c.prefix+w+c.suffix;continue}if(!h){var E=m?"an array":"a string";throw new TypeError('Expected "'.concat(c.name,'" to be ').concat(E))}}return u}}function Be(e,r){var t=[],o=It(e,t,r);return Zr(o,t,r)}function Zr(e,r,t){t===void 0&&(t={});var o=t.decode,s=o===void 0?function(a){return a}:o;return function(a){var n=e.exec(a);if(!n)return!1;for(var i=n[0],l=n.index,u=Object.create(null),d=function(p){if(n[p]===void 0)return"continue";var h=r[p-1];h.modifier==="*"||h.modifier==="+"?u[h.name]=n[p].split(h.prefix+h.suffix).map(function(m){return s(m,h)}):u[h.name]=s(n[p],h)},c=1;c<n.length;c++)d(c);return{path:i,index:l,params:u}}}function $(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function $e(e){return e&&e.sensitive?"":"i"}function eo(e,r){if(!r)return e;for(var t=/\((?:\?<(.*?)>)?(?!\?)/g,o=0,s=t.exec(e.source);s;)r.push({name:s[1]||o++,prefix:"",suffix:"",modifier:"",pattern:""}),s=t.exec(e.source);return e}function to(e,r,t){var o=e.map(function(s){return It(s,r,t).source});return new RegExp("(?:".concat(o.join("|"),")"),$e(t))}function ro(e,r,t){return oo(Ot(e,t),r,t)}function oo(e,r,t){t===void 0&&(t={});for(var o=t.strict,s=o===void 0?!1:o,a=t.start,n=a===void 0?!0:a,i=t.end,l=i===void 0?!0:i,u=t.encode,d=u===void 0?function(A){return A}:u,c=t.delimiter,p=c===void 0?"/#?":c,h=t.endsWith,m=h===void 0?"":h,_="[".concat($(m),"]|$"),w="[".concat($(p),"]"),E=n?"^":"",g=0,y=e;g<y.length;g++){var f=y[g];if(typeof f=="string")E+=$(d(f));else{var v=$(d(f.prefix)),b=$(d(f.suffix));if(f.pattern)if(r&&r.push(f),v||b)if(f.modifier==="+"||f.modifier==="*"){var P=f.modifier==="*"?"?":"";E+="(?:".concat(v,"((?:").concat(f.pattern,")(?:").concat(b).concat(v,"(?:").concat(f.pattern,"))*)").concat(b,")").concat(P)}else E+="(?:".concat(v,"(").concat(f.pattern,")").concat(b,")").concat(f.modifier);else{if(f.modifier==="+"||f.modifier==="*")throw new TypeError('Can not repeat "'.concat(f.name,'" without a prefix and suffix'));E+="(".concat(f.pattern,")").concat(f.modifier)}else E+="(?:".concat(v).concat(b,")").concat(f.modifier)}}if(l)s||(E+="".concat(w,"?")),E+=t.endsWith?"(?=".concat(_,")"):"$";else{var D=e[e.length-1],N=typeof D=="string"?w.indexOf(D[D.length-1])>-1:D===void 0;s||(E+="(?:".concat(w,"(?=").concat(_,"))?")),N||(E+="(?=".concat(w,"|").concat(_,")"))}return new RegExp(E,$e(t))}function It(e,r,t){return e instanceof RegExp?eo(e,r):Array.isArray(e)?to(e,r,t):ro(e,r,t)}de();T();ne();V();var jt=(e,r,t)=>o=>{switch(o.type){case"header":return!!e?.[o.key.toLowerCase()]&&new RegExp(o.value??"").test(e[o.key.toLowerCase()]??"");case"cookie":return!!r?.[o.key]&&new RegExp(o.value??"").test(r[o.key]??"");case"query":return t[o.key]&&Array.isArray(o.value)?o.value.reduce((s,a)=>s||new RegExp(a).test(t[o.key]),!1):new RegExp(o.value??"").test(t[o.key]??"");case"host":return e?.host!==""&&new RegExp(o.value??"").test(e.host);default:return!1}};function Se(e,r,t=!1){return r?r.reduce((o,s)=>o===!1?!1:t?!e(s):e(s),!0):!0}var so=e=>r=>{x("value",r);let t=e(r);return t?t.params:{}},ao=(e,r,t)=>o=>{if(!o.value)return{};let s=new RegExp(`^${o.value}$`),a=n=>n.match(s)?.groups??{};switch(o.type){case"header":return a(e[o.key.toLowerCase()]??"");case"cookie":return a(r[o.key]??"");case"query":return Array.isArray(t[o.key])?a(t[o.key].join(",")):a(t[o.key]??"");case"host":return a(e.host??"")}};function Mt(e,r,t){if(!e)return t;let{params:o}=e;return Object.keys(o).length>0?r(o):t}function Dt(e,r){if(!r)return{};let t=jt(e.headers,e.cookies,e.query),o={},s=q(e);for(let{headers:a,has:n,missing:i,regex:l,source:u,locale:d}of r){let c=d===!1?e.rawPath:s;if(new RegExp(l).test(c)&&Se(t,n)&&Se(t,i,!0)){let h=Be(u)(c);a.forEach(m=>{try{let _=Mt(h,ee(m.key),m.key),w=Mt(h,ee(m.value),m.value);o[_]=w}catch{x(`Error matching header ${m.key} with value ${m.value}`),o[m.key]=m.value}})}}return o}function ue(e,r){let{rawPath:t,headers:o,query:s,cookies:a}=e,n=q(e),i=jt(o,a,s),l=ao(o,a,s),u=r.find(h=>{let m=h.locale===!1?t:n;return new RegExp(h.regex).test(m)&&Se(i,h.has)&&Se(i,h.missing,!0)}),d=s,c=t,p=Re(u?.destination);if(x("isExternalRewrite",p),u){let{pathname:h,protocol:m,hostname:_,queryString:w}=_t(u.destination,p),E=u.locale===!1?t:n,g=w.replaceAll("+","%20");x("urlParts",{pathname:h,protocol:m,hostname:_,queryString:w});let y=ee(ce(h??"")??""),f=ee(ce(_??"")??""),v=ee(ce(g??"")??""),b={...so(Be(ce(u?.source)??""))(E),...u.has?.reduce((O,W)=>Object.assign(O,l(W)),{}),...u.missing?.reduce((O,W)=>Object.assign(O,l(W)),{})},P=Object.keys(b).length>0,D=g,N=_,A=h;P&&(A=Ce(y(b)),N=Ce(f(b)),D=Ce(v(b))),c=p?`${m}//${N}${A}`:`${A}`,d={...s,...bt(D)},x("rewrittenUrl",{rewrittenUrl:c,finalQuery:d,isUsingParams:P})}return{internalEvent:{...e,rawPath:c,url:`${c}${ie(d)}`},__rewrite:u,isExternalRewrite:p}}function no(e){let r=new URL(e.url,"http://localhost"),t=Q();if(r.host!=="localhost"||R.skipTrailingSlashRedirect||e.rawPath.startsWith("/api/"))return!1;if(R.trailingSlash&&!e.headers["x-nextjs-data"]&&!e.rawPath.endsWith("/")&&!e.rawPath.match(/[\w-]+\.[\w]+$/g)){let o=e.url.split("?");return{type:e.type,statusCode:308,headers:{Location:`${o[0]}/${o[1]?`?${o[1]}`:""}`},body:t,isBase64Encoded:!1}}if(!R.trailingSlash&&e.rawPath.endsWith("/")&&e.rawPath!=="/"){let o=e.url.split("?");return{type:e.type,statusCode:308,headers:{Location:`${o[0].replace(/\/$/,"")}${o[1]?`?${o[1]}`:""}`},body:t,isBase64Encoded:!1}}return!1}function Lt(e,r){let t=no(e);if(t)return t;let{internalEvent:o,__rewrite:s}=ue(e,r.filter(a=>!a.internal));if(s&&!s.internal)return{type:e.type,statusCode:s.statusCode??308,headers:{Location:o.url},body:Q(),isBase64Encoded:!1}}function kt(e,r){let{rawPath:t,query:o}=e,s=`${R.basePath??""}/_next/data/${r}`;if(t.startsWith("/_next/data")&&!t.startsWith(s))return{type:e.type,statusCode:404,body:Ae("{}"),headers:{"Content-Type":"application/json"},isBase64Encoded:!1};if(t.startsWith(s)&&t.endsWith(".json")){let a=t.slice(s.length,-5).replace(/^\/index$/,"/");return o.__nextDataReq="1",{...e,rawPath:a,query:o,url:`${a}${ie(o)}`}}return e}function Ft(e,r){let{rawPath:t}=e,{dynamicRoutes:o,routes:s}=r,a=Object.entries(o).filter(([,{fallback:d}])=>d===!1).some(([,{routeRegex:d}])=>new RegExp(d).test(t)),n=R.i18n?.locales,l=n?.includes(t.split("/")[1])||n===void 0?t:`/${R.i18n?.defaultLocale}${t}`,u=Object.keys(s).includes(l);return a&&!u?{event:{...e,rawPath:"/404",url:"/404",headers:{...e.headers,"x-invoke-status":"404"}},isISR:!1}:{event:e,isISR:a||u}}j();de();ne();V();var io=ft,co=At(io);function lo(){return import("./middleware.mjs")}async function qt(e,r=lo){let t=e.headers;if(t["x-isr"])return e;let o=q(e);if(!co.some(v=>v.test(o)))return e;let a=e.url.startsWith("http://")?"http:":"https:",n=t.host?`${a}//${t.host}`:"http://localhost:3000",i=new URL(o,n);i.search=ie(e.query);let l=i.toString(),d=await(await r()).default({geo:{city:decodeURIComponent(t["x-open-next-city"]),country:t["x-open-next-country"],region:t["x-open-next-region"],latitude:t["x-open-next-latitude"],longitude:t["x-open-next-longitude"]},headers:t,method:e.method||"GET",nextConfig:{basePath:R.basePath,i18n:R.i18n,trailingSlash:R.trailingSlash},url:l,body:St(e.method,e.body)}),c=d.status,p=d.headers,h={},m={};p.delete("x-middleware-override-headers");let _="x-middleware-request-";if(p.forEach((v,b)=>{if(b.startsWith(_)){let P=b.substring(_.length);h[P]=v}else b.toLowerCase()==="set-cookie"?m[b]=m[b]?[...m[b],v]:[v]:m[b]=v}),c>=300&&c<400)return m.location=p.get("location")?.replace("http://localhost:3000",`${a}//${e.headers.host}`)??m.location,{body:Q(),type:e.type,statusCode:c,headers:m,isBase64Encoded:!1};let w=p.get("x-middleware-rewrite"),E=!1,g=!1,y=e.query,f=e.url;if(w)if(Re(w,e.headers.host))f=w,E=!0,g=!0;else{let v=new URL(w);f=v.pathname,y.__nextDataReq?y={__nextDataReq:y.__nextDataReq}:y={},v.searchParams.forEach((b,P)=>{y[P]=b}),E=!0}if(d.body){let v=d.body;return{type:e.type,statusCode:c,headers:m,body:v,isBase64Encoded:!1}}return{responseHeaders:m,url:f,rawPath:E?f??e.rawPath:e.rawPath,type:e.type,headers:{...e.headers,...h},body:e.body,method:e.method,query:y,cookies:e.cookies,remoteAddress:e.remoteAddress,isExternalRewrite:g}}j();var uo=`^/(?:${M.locales.map(e=>`${e}/?`).join("|")})?`,po=M.basePath?`^${M.basePath}/?`:"^/",Ue=`${M.basePath??""}/api`,fo=uo.replace("^/",po);function Bt(e){let r=e.map(s=>({page:s.page,regexp:new RegExp(s.regex.replace("^/",fo))})),t=new Set,o=new Set;for(let[s,a]of Object.entries(ht))s.endsWith("page")?t.add(a):s.endsWith("route")&&o.add(a);return function(a){return r.filter(i=>i.regexp.test(a)).map(i=>{let l="page";return t.has(i.page)?l="app":o.has(i.page)&&(l="route"),{route:i.page,type:l}})}}var We=Bt(M.routes.static),ze=Bt(M.routes.dynamic);var pe="x-middleware-response-",Ut=pe.length,Xe="x-opennext-",Wt=`${Xe}initial-path`,Ke=`${Xe}resolved-routes`,ho={"x-open-next-city":"x-vercel-ip-city","x-open-next-country":"x-vercel-ip-country","x-open-next-region":"x-vercel-ip-country-region","x-open-next-latitude":"x-vercel-ip-latitude","x-open-next-longitude":"x-vercel-ip-longitude"};function $t(e,r,t=!0){let o=t?pe:"";Object.entries(r).forEach(([s,a])=>{a&&(e[o+s]=Array.isArray(a)?a.join(","):a)})}async function Ge(e){for(let[g,y]of Object.entries(ho)){let f=e.headers[g];f&&(e.headers[y]=f)}for(let g of Object.keys(e.headers))(g.startsWith(Xe)||g.startsWith(pe))&&delete e.headers[g];let r=Dt(e,pt),t=kt(e,J);if("statusCode"in t)return t;let o=Lt(t,M.redirects);if(o)return x("redirect",o),o;let s=await qt(t);if("statusCode"in s)return s;let n=s.responseHeaders,i=s.isExternalRewrite??!1;if(t=s,!i){let g=ue(t,M.rewrites.beforeFiles);t=g.internalEvent,i=g.isExternalRewrite}let l=We(t.rawPath),u=!i&&l.length>0;if(!(u||i)){let g=ue(t,M.rewrites.afterFiles);t=g.internalEvent,i=g.isExternalRewrite}let{event:d,isISR:c}=Ft(t,X);t=d;let p=ze(t.rawPath),h=!i&&p.length>0;if(!(h||u||i)){let g=ue(t,M.rewrites.fallback);t=g.internalEvent,i=g.isExternalRewrite}let m=t.rawPath===Ue||t.rawPath.startsWith(`${Ue}/`),_=t.rawPath.startsWith("/_next/image");if(u||h||i||m||_||We(t.rawPath).length>0||ze(t.rawPath).length>0||(t={...t,rawPath:"/404",url:"/404",headers:{...t.headers,"x-middleware-response-cache-control":"private, no-cache, no-store, max-age=0, must-revalidate"}}),globalThis.openNextConfig.dangerous?.enableCacheInterception&&!("statusCode"in t)&&(x("Cache interception enabled"),t=await Ht(t),"statusCode"in t))return $t(t.headers,{...n,...r},!1),t;$t(t.headers,{...n,...r});let E=[...l,...p];return x("resolvedRoutes",E),{internalEvent:t,isExternalRewrite:i,origin:!1,isISR:c,initialPath:e.rawPath,resolvedRoutes:E}}j();T();import go from"next/dist/server/next-server.js";T();var mo=L("node:module"),Ea=mo._resolveFilename;var xo=L.resolve("./cache.cjs"),Qe=new go.default({conf:{...R,compress:!1,cacheHandler:xo,cacheMaxMemorySize:0,experimental:{...R.experimental,trustHostHeader:!0}},customServer:!1,dev:!1,dir:__dirname}).getRequestHandler();globalThis.__openNextAls=new yo;yt();async function Xt(e,r){let t=e.headers;return xt({isISRRevalidation:t["x-isr"]==="1"},async()=>{t["x-forwarded-host"]&&(t.host=t["x-forwarded-host"]),x("internalEvent",e);let o={initialPath:t[Wt]??e.rawPath,resolvedRoutes:t[Ke]?JSON.parse(t[Ke]):[]},s={internalEvent:e,isExternalRewrite:!1,origin:!1,isISR:!1,...o};try{s=await Ge(e)}catch(y){Me("Routing failed.",y)}let a="type"in s?s.headers:s.internalEvent.headers,n={};for(let[y,f]of Object.entries(a)){if(!y.startsWith(pe))continue;let v=y.slice(Ut);n[v]=f,a[v]=f,delete a[y]}if("isExternalRewrite"in s&&s.isExternalRewrite===!0)try{s=await globalThis.proxyExternalRequest.proxy(s.internalEvent)}catch(y){S("External request failed.",y),s={internalEvent:{type:"core",rawPath:"/500",method:"GET",headers:{},url:"/500",query:{},cookies:{},remoteAddress:""},isExternalRewrite:!1,isISR:!1,origin:!1,initialPath:e.rawPath,resolvedRoutes:[{route:"/500",type:"page"}]}}if("type"in s){if(r){let y=qe({internalEvent:e,isExternalRewrite:!1,isISR:!1,resolvedRoutes:[],origin:!1,initialPath:e.rawPath},a,r);y.statusCode=s.statusCode,y.flushHeaders();let[f,v]=s.body.tee();for await(let b of f)y.write(b);y.end(),s.body=v}return s}let i=s.internalEvent;x("preprocessedEvent",i);let l={method:i.method,url:i.url,headers:{...a,purpose:"prefetch"},body:i.body,remoteAddress:i.remoteAddress},u=globalThis.openNextConfig.dangerous?.headersAndCookiesPriority?globalThis.openNextConfig.dangerous.headersAndCookiesPriority(i):"middleware",d=globalThis.__openNextAls.getStore();d&&(d.mergeHeadersPriority=u);let c=new ae(l),p=qe(s,n,r);await wo(c,p,i);let{statusCode:h,headers:m,isBase64Encoded:_,body:w}=Rt(p),E={type:e.type,statusCode:h,headers:m,body:w,isBase64Encoded:_},g=d?.requestId;return g&&delete globalThis.lastModified[g],E})}async function wo(e,r,t){delete e.body;try{await Qe(e,r)}catch(o){o.constructor.name==="NoFallbackError"?await zt("404",r,t):(S("NextJS request failed.",o),await zt("500",r,t))}}async function zt(e,r,t){try{let o=new ae({method:"GET",url:`/${e}`,headers:t.headers,body:t.body,remoteAddress:t.remoteAddress});await Qe(o,r)}catch(o){S("NextJS request failed.",o),r.setHeader("Content-Type","application/json"),r.end(JSON.stringify({message:"Server failed to respond.",details:o},null,2))}}async function gr(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(Yt(),Qt))).default}async function xr(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(Vt(),Jt))).default}async function yr(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(ar(),sr))).default}async function wr(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(ir(),nr))).default}async function Er(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(lr(),dr))).default}async function vr(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(fr(),pr))).default}async function br(e){return typeof e=="function"?e():(await Promise.resolve().then(()=>(mr(),hr))).default}async function _r(){let e=await import("./open-next.config.mjs").then(a=>a.default),r=globalThis.fnName?e.functions[globalThis.fnName]:e.default;globalThis.serverId=gt(),globalThis.openNextConfig=e,globalThis.queue=await wr(r.override?.queue),globalThis.incrementalCache=await Er(r.override?.incrementalCache),globalThis.tagCache=await yr(r.override?.tagCache),globalThis.proxyExternalRequest=await vr(r.override?.proxyExternalRequest),globalThis.cdnInvalidationHandler=await br(r.override?.cdnInvalidation),globalThis.lastModified={};let t=await gr(r.override?.converter),{wrapper:o,name:s}=await xr(r.override?.wrapper);return x("Using wrapper",s),o(Xt,t)}se();mt();Vo();Jo();globalThis.internalFetch=fetch;var Pn=await _r();function Jo(){process.chdir(__dirname)}function Vo(){process.env.NEXT_BUILD_ID=J}export{Pn as handler};
/*! Bundled license information:

aws4fetch/dist/aws4fetch.esm.mjs:
  (**
   * @license MIT <https://opensource.org/licenses/MIT>
   * @copyright Michael Hart 2024
   *)
*/
